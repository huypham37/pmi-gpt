# ACTIVE MEMORY: Issue #24
## Link
https://github.com/huypham37/pmi-gpt/issues/24

## Context & Goal
Replace MarkItDown with Docling (IBM, Python) for document text extraction in the Project Context layer. Docling provides advanced PDF understanding (layout, tables, OCR, reading order) vs MarkItDown's basic extraction.

Integration approach: **spawn Docling CLI as subprocess** from Electron main process.

```
User uploads PDF/DOCX
       ↓
[CONTEXT_ADD_DOCUMENT IPC handler]
  ├── Copy file to workspace context/docs/
  ├── Spawn `docling <filepath> --to md` subprocess
  ├── Capture markdown output
  └── Store as extractedText in ContextDocument
       ↓
manifest.json updated
```

## Key Decisions
- Subprocess via `child_process.spawn` (not HTTP server, not MCP)
- Docling CLI outputs markdown to stdout or temp file
- No fallback — if Docling is not installed, notify user to install it (`pip install docling`)
- Expand supported file types: PPTX, XLSX, HTML, images (Docling supports all)
- Python 3.10+ required on user machine

## Files to Change
| File | What to change |
|------|---------------|
| `apps/electron/src/main/docling-extract.ts` | New: utility to spawn Docling CLI and capture output |
| `apps/electron/src/main/ipc.ts` | Update `CONTEXT_ADD_DOCUMENT` handler to use Docling instead of MarkItDown |
| `apps/electron/src/renderer/components/testcases/TestCasesNavigatorPanel.tsx` | Update file type filter in upload dialog |
| `apps/electron/src/shared/types.ts` | Expand `ContextDocument.type` to include new formats |

## Plan
- [ ] Create `docling-extract.ts` utility (spawn CLI, parse output)
- [ ] Update `CONTEXT_ADD_DOCUMENT` IPC handler to use Docling
- [ ] Detect if Docling is installed; if not, surface error notification to user with install instructions
- [ ] Expand supported file types in UI and types
- [ ] Tests: Docling subprocess extraction, fallback behavior
- [ ] Document Python/Docling install requirement

## Progress Log
### 2026-02-18 Initialization
- Spawned from issue #24.
- Research: Docling is Python-only (53k⭐, IBM), supports PDF/DOCX/PPTX/XLSX/HTML/images with advanced layout detection, OCR, table structure.
- Decision: subprocess approach chosen over Docling Serve (HTTP) or Docling MCP.

Current Step: Not started — issue created, planning complete.
Next immediate: Implement `docling-extract.ts` subprocess utility.
